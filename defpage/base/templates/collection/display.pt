<!doctype html>
<html>
  <metal:block use-macro="layout.macros['master']">
    <metal:block fill-slot="main">
      <div class="unified">
	<div class="alt_label">
	  ${title}
	</div>
	<table style="width:100%; margin:0;">
	  <tr>
	    <td style="width:20%"><a href="/collection/${active_collection_id}/properties">Properties</a></td>
	    <td style="width:20%"><a href="/collection/${active_collection_id}/source">Source</a></td>
	    <td style="width:20%"><a href="/collection/${active_collection_id}/transmission">Transmission</a></td>
	    <td style="width:20%"><a href="/collection/${active_collection_id}/roles">Roles</a></td>
	    <td style="width:20%"><a href="/collection/${active_collection_id}/delete">Delete</a></td>
	  </tr>
	</table>
      </div>

      <table class="collection_info" width="100%">
	<tr>
	  <td>${length} documents <a href="#" id="show_doclist" tal:condition="length >0">[ show ]</a></td>
	  <td>
	    <tal:block condition="source_title">Collection source: ${source_title}</tal:block>
	    <tal:block condition="not source_title">No source specified for this collection</tal:block>
	  </td>
	</tr>
      </table>
      <div id="documents_listing"></div>
    </metal:block>

    <metal:block fill-slot="scripts">
      <script id="template-doclist" type="text/x-tmpl">
        <div style="text-align:right; padding-right:10px;">
          <a href="#" id="close" onclick="$('#documents_listing').empty(); $('#show_doclist').show(); return false;">[ hide ]</a>
        </div>
        {% for (var i=0; i<o.documents.length; i++) { %}
	<a href="#" onclick="return false;" class="document_item {%=o.documents[i]['source_css']%}">
	  <span class="document_item_title">{%=o.documents[i]['title']%}</span>
	</a>
	{% } %}
      </script>

      <script type="text/javascript">
        $(function () {
	    $("#show_doclist").click(function () {
		var place = document.getElementById("documents_listing");
		$.getJSON("/collection/${active_collection_id}/documents", {}, function (data) {
		    place.innerHTML = tmpl("template-doclist", {"documents":data});
		});
		$(this).hide();
		return false;
	    });
	});
      </script>
    </metal:block>

  </metal:block>
</html>
